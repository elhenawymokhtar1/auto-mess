# ๐ก๏ธ ุชุญุฏูุซ ููุชุฑุฉ ุงูุฑุณุงุฆู ููุตูุญุงุช ุงููุนุทูุฉ

## ๐ฏ **ุงููุดููุฉ ุงูุชู ุชู ุญููุง**

**ุงููุดููุฉ:** ุงูุตูุญุงุช ุงููุนุทูุฉ ูู ุงููุงุฌูุฉ ูุงูุช ูุง ุชุฒุงู ุชุณุชูุจู ูุชุนุงูุฌ ุงูุฑุณุงุฆู ูู ุงูู Webhook.

**ุงูุญู:** ุฅุถุงูุฉ ูุญุต ุญุงูุฉ ุงูุตูุญุฉ ูู ุงูู Webhook ูุจู ูุนุงูุฌุฉ ุฃู ุฑุณุงูุฉ.

---

## โจ **ุงูุชุญุฏูุซุงุช ุงููุถุงูุฉ**

### **๐ ูุญุต ุญุงูุฉ ุงูุตูุญุฉ**
```javascript
// ูุญุต ุญุงูุฉ ุงูุตูุญุฉ ูุจู ูุนุงูุฌุฉ ุงูุฑุณุงูุฉ
const { data: pageSettings } = await supabase
  .from('facebook_settings')
  .select('is_active, page_name, disconnected_at')
  .eq('page_id', pageId)
  .single();

// ุฅุฐุง ูุงูุช ุงูุตูุญุฉ ูุนุทูุฉุ ุชุฌุงูู ุงูุฑุณุงูุฉ
if (pageSettings.is_active === false) {
  console.log(`๐ซ ุงูุตูุญุฉ ูุนุทูุฉ - ุชู ุชุฌุงูู ุงูุฑุณุงูุฉ`);
  return; // ุชููู ููุง
}
```

### **๐ ุฅุญุตุงุฆูุงุช ุงูุฑุณุงุฆู ุงููุชุฌุงููุฉ**
- **ุนุฏุงุฏ ุงูุฑุณุงุฆู ุงููุชุฌุงููุฉ:** `messagesIgnored`
- **ุขุฎุฑ ุฑุณุงูุฉ ูุชุฌุงููุฉ:** `lastIgnoredMessage`
- **ุณุจุจ ุงูุชุฌุงูู:** `reason: 'page_disabled'`

### **๐ ุชุญุฏูุซ ุงูุฅุตุฏุงุฑ**
- **ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ:** `v2.1.0`
- **ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:** ููุชุฑุฉ ุงูุตูุญุงุช ุงููุนุทูุฉ

---

## ๐จ **ูุงุฌูุฉ ุงููุณุชุฎุฏู**

### **๐ ุฅุญุตุงุฆูุงุช ูุญุฏุซุฉ**
```
ุงูุฑุณุงุฆู ุงููุณุชูุจูุฉ: 38 (ุฃุฎุถุฑ)
ุงูุฑุณุงุฆู ุงููุชุฌุงููุฉ: 0 (ุจุฑุชูุงูู)
```

### **๐ ุชุดุฎูุต ููุตู**
- **Health Check:** ูุนุฑุถ ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุชุฌุงููุฉ
- **Stats Endpoint:** ูุนุฑุถ ุชูุงุตูู ุขุฎุฑ ุฑุณุงูุฉ ูุชุฌุงููุฉ
- **Logs:** ุชุณุฌูู ููุตู ููู ุฑุณุงูุฉ ูุชุฌุงููุฉ

---

## ๐งช **ููููุฉ ุงูุงุฎุชุจุงุฑ**

### **1๏ธโฃ ุฅุนุฏุงุฏ ุงูุงุฎุชุจุงุฑ:**
```bash
# ุชุดุบูู ุงูู Webhook ุงูุฌุฏูุฏ
node webhook-server.js

# ุชุดุบูู ngrok
ngrok http 3001
```

### **2๏ธโฃ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:**
1. **ุชุฃูุฏ ูู ูุฌูุฏ ุตูุญุฉ ูุนุทูุฉ** ูู ุงูุฅุนุฏุงุฏุงุช
2. **ุฃุฑุณู ุฑุณุงูุฉ** ูู Facebook ููุฐู ุงูุตูุญุฉ
3. **ุฑุงูุจ ุงูู logs** - ุณุชุดูู ุฑุณุงูุฉ ุงูุชุฌุงูู
4. **ุชุญูู ูู ุงูุฅุญุตุงุฆูุงุช** - ุณุชุฒูุฏ `messagesIgnored`

### **3๏ธโฃ ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
```
๐ ูุญุต ุญุงูุฉ ุงูุตูุญุฉ...
๐ ุญุงูุฉ ุงูุตูุญุฉ "ุงุณู ุงูุตูุญุฉ": {
  is_active: false,
  disconnected_at: "2025-05-30T20:45:00.000Z"
}
๐ซ ุงูุตูุญุฉ "ุงุณู ุงูุตูุญุฉ" ูุนุทูุฉ - ุชู ุชุฌุงูู ุงูุฑุณุงูุฉ
๐ ุชุงุฑูุฎ ูุทุน ุงูุงุชุตุงู: 2025-05-30T20:45:00.000Z
```

---

## ๐ **ูุฑุงูุจุฉ ุงููุธุงู**

### **๐ฅ Health Check:**
```bash
curl http://localhost:3001/health
```

**ุงููุชูุฌุฉ:**
```json
{
  "status": "OK",
  "messagesReceived": 38,
  "messagesIgnored": 5,
  "lastIgnoredMessage": {
    "pageId": "260345600493273",
    "pageName": "ุงุณู ุงูุตูุญุฉ",
    "senderId": "user123",
    "timestamp": "2025-05-30T21:00:00.000Z",
    "reason": "page_disabled"
  },
  "version": "2.1.0"
}
```

### **๐ Stats Endpoint:**
```bash
curl http://localhost:3001/stats
```

---

## ๐ง **ุงูุชุญุฏูุซุงุช ุงูุชูููุฉ**

### **๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- **ุงุณุชุนูุงู ุฌุฏูุฏ:** ูุญุต `is_active` ู `disconnected_at`
- **ููุฑุณุฉ ูุญุณูุฉ:** ุนูู `page_id` ููุจุญุซ ุงูุณุฑูุน

### **๐ Logging ูุญุณู:**
```javascript
console.log(`๐ซ ุงูุตูุญุฉ "${pageName}" ูุนุทูุฉ - ุชู ุชุฌุงูู ุงูุฑุณุงูุฉ`);
console.log(`๐ ุชุงุฑูุฎ ูุทุน ุงูุงุชุตุงู: ${disconnected_at}`);
```

### **๐ ุฅุญุตุงุฆูุงุช ุฌุฏูุฏุฉ:**
```javascript
systemStats.messagesIgnored = (systemStats.messagesIgnored || 0) + 1;
systemStats.lastIgnoredMessage = {
  pageId, pageName, senderId, timestamp, reason
};
```

---

## ๐ก๏ธ **ุงูุฃูุงู ูุงูุญูุงูุฉ**

### **๐ ููุงุฆุฏ ุงูููุชุฑุฉ:**
- **ููุน ุงูุฑุณุงุฆู ุบูุฑ ุงููุฑุบูุจุฉ:** ููุตูุญุงุช ุงููุนุทูุฉ
- **ุชูููุฑ ุงูููุงุฑุฏ:** ุนุฏู ูุนุงูุฌุฉ ุฑุณุงุฆู ุบูุฑ ุถุฑูุฑูุฉ
- **ุชุญูู ุฏููู:** ูู ูู ุตูุญุฉ ุจุดูู ูููุตู

### **๐ ุชุญุณูู ุงูุฃุฏุงุก:**
- **ูุญุต ุณุฑูุน:** ุงุณุชุนูุงู ูุงุญุฏ ุจุณูุท
- **ุฅููุงู ูุจูุฑ:** ูุจู ุงููุนุงูุฌุฉ ุงูุซูููุฉ
- **ุฐุงูุฑุฉ ูุญุณูุฉ:** ุนุฏู ุญูุธ ุฑุณุงุฆู ุบูุฑ ูุทููุจุฉ

---

## ๐ฏ **ุงููุชูุฌุฉ ุงูููุงุฆูุฉ**

### **โ ูุง ุชู ุชุญูููู:**
- **๐ก๏ธ ููุชุฑุฉ ูุงููุฉ** ููุตูุญุงุช ุงููุนุทูุฉ
- **๐ ุฅุญุตุงุฆูุงุช ููุตูุฉ** ููุฑุณุงุฆู ุงููุชุฌุงููุฉ
- **๐ ูุฑุงูุจุฉ ุดุงููุฉ** ูุญุงูุฉ ุงููุธุงู
- **๐ ุชุณุฌูู ูุงุถุญ** ูุฌููุน ุงูุนูููุงุช

### **๐ ุงูููุงุฆุฏ:**
- **ุชุญูู ูุงูู** ูู ุงุณุชูุจุงู ุงูุฑุณุงุฆู
- **ุฃุฏุงุก ูุญุณู** ุจุนุฏู ูุนุงูุฌุฉ ุฑุณุงุฆู ุบูุฑ ูุทููุจุฉ
- **ูุฑุงูุจุฉ ุฏูููุฉ** ููุดุงุท ูู ุตูุญุฉ
- **ุฃูุงู ุนุงูู** ุถุฏ ุงูุฑุณุงุฆู ุบูุฑ ุงููุฑุบูุจุฉ

---

## ๐ **ุงูุฏุนู ูุงูุตูุงูุฉ**

### **๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก:**
```bash
# ูุญุต ุงูู logs
tail -f webhook.log

# ูุญุต ุงูุฅุญุตุงุฆูุงุช
curl http://localhost:3001/stats

# ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
curl http://localhost:3001/health
```

### **๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก:**
- **ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุชุฌุงููุฉ** ูุฌุจ ุฃู ูููู ููุทูู
- **ุขุฎุฑ ุฑุณุงูุฉ ูุชุฌุงููุฉ** ุชุนุทู ุชูุงุตูู ูููุฏุฉ
- **ุฃุฎุทุงุก ุงููุธุงู** ูุฌุจ ุฃู ุชููู ุตูุฑ

**ุงููุธุงู ุงูุขู ูุนูู ุจููุงุกุฉ ุนุงููุฉ ูุน ุญูุงูุฉ ูุงููุฉ! ๐ก๏ธโจ**
